{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold"><i class="bi bi-folder2-open me-2"></i>조사 프로젝트 선택</h3>
        
        <div style="width: 300px;">
            <input type="text" id="searchInput" class="form-control" placeholder="조사명 검색...">
        </div>
    </div>

    <div class="row" id="surveyList">
        {% for survey in surveys %}
        <div class="col-md-4 mb-4 survey-card" data-name="{{ survey.survey_name }}">
            <div class="card h-100 shadow-sm border-0 hover-effect">
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span class="badge bg-primary">{{ survey.survey_code }}</span>
                        <span class="text-muted small">{{ survey.survey_year }}년</span>
                    </div>
                    <h5 class="card-title fw-bold mb-2">{{ survey.survey_name }}</h5>
                    
                    <p class="card-text text-muted small text-truncate" 
                       title="{{ survey.description|default:'설명 없음' }}" 
                       style="cursor: help;">
                        {{ survey.description|default:"설명 없음" }}
                    </p>
                    
                    <hr>
                    
                    <div class="d-grid">
                        <a href="{% url 'collection_degree_list' survey.id %}" class="btn btn-outline-primary fw-bold">
                            <i class="bi bi-box-arrow-in-right me-1"></i> 입장하기
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center py-5">
            <p class="text-muted">배정된 조사가 없습니다.</p>
        </div>
        {% endfor %}
    </div>
</div>

<script>
// 검색 필터 스크립트
document.getElementById('searchInput').addEventListener('keyup', function() {
    let filter = this.value.toUpperCase();
    let cards = document.querySelectorAll('.survey-card');
    cards.forEach(card => {
        let name = card.getAttribute('data-name').toUpperCase();
        card.style.display = name.indexOf(filter) > -1 ? "" : "none";
    });
});
</script>
{% endblock %}